int func_0x803be50(int *p1, int p2, int p3, int *p4)
{
  r4 = p1;
  r8 = p2;
  r6 = p3;
  r9 = p4;
  r0 = 0;
  *r9 = 0;
  r1 = sp;
  r0 = p1;
  r0 = func_0x803d6fc(p1, sp);
  cond1 = func_0x803d6fc(p1, sp) == 0;
  r0 = *(p1 + 17);
  cond0 = (*(p1 + 17)) == 0;
  if (cond1 || cond0)
  {
    return p1;
  }

  r0 = *(p1 + 16);
  if (~((*(p1 + 16)) & 1))
  {
    r0 = 7;
    return;
  }

  r1 = *(p1 + 20);
  r0 = *(p1 + 12);
  r0 = (*(p1 + 12)) - (*(p1 + 20));
  if (p3 > ((*(p1 + 12)) - (*(p1 + 20))))
  {
    r6 = (*(p1 + 12)) - (*(p1 + 20));
  }

  if (r6 == 0)
  {
    r0 = 0;
    return;
  }

  sl = 1;
  while (1)
  {
    r0 = *(r4 + 20);
    r1 = (*(r4 + 20)) << 20;
    r1 = ((*(r4 + 20)) << 20) >> 20;
    if ((((*(r4 + 20)) << 20) >> 20) == 0)
    {
      r1 = *(sp + 0);
      r1 = *((*(sp + 0)) + 10);
      r1 = (*((*(sp + 0)) + 10)) - 1;
      var0 = ((*((*(sp + 0)) + 10)) - 1) & ((*(r4 + 20)) >> 12);
      if (var0 == 0)
      {
        if ((*(r4 + 20)) == 0)
        {
          r0 = *(r4 + 8);
        }
        else
        {
          r0 = r4;
          r1 = *(r4 + 24);
          func_0x803c790();
          ;
        }

        if (r0 < 2)
        {
          r0 = 2;
          *(r4 + 17) = 2;
          return;
        }

        if (r0 == (-1))
        {
          *(r4 + 17) = sl;
          r0 = 1;
          return;
        }

        *(r4 + 24) = r0;
      }

      r1 = *(r4 + 24);
      r0 = *(sp + 0);
      func_0x803b054();
      ;
      if ((*(sp + 0)) == 0)
      {
        r0 = 2;
        *(r4 + 17) = 2;
      }

      fp = r0 + var0;
      r5 = r6 >> 12;
      if ((r6 >> 12) == 0)
      {
        r2 = *(r4 + 28);
        if ((*(r4 + 28)) != (r0 + var0))
        {
          r0 = *(r4 + 16);
          if ((*(r4 + 16)) & 128)
          {
            r0 = *(sp + 0);
            r3 = 1;
            r1 = r4 + 40;
            r0 = *((*(sp + 0)) + 1);
            func_0x803ba7e();
            ;
            if ((*((*(sp + 0)) + 1)) != 0)
            {
              *(r4 + 17) = sl;
              r0 = 1;
              return;
            }

            r0 = *(r4 + 16);
            r0 = (*(r4 + 16)) & 127;
            *(r4 + 16) = (*(r4 + 16)) & 127;
          }

          r0 = *(sp + 0);
          r3 = 1;
          r2 = r0 + var0;
          r0 = *((*(sp + 0)) + 1);
          r1 = r4 + 40;
          r0 = func_0x803ba6a(*((*(sp + 0)) + 1), r4 + 40, r0 + var0, 1);
          if (func_0x803ba6a(*((*(sp + 0)) + 1), r4 + 40, r0 + var0, 1) == 0)
          {
            *(r4 + 17) = sl;
            r0 = 1;
            return;
          }

        }

        *(r4 + 28) = r0 + var0;
      }
      else
      {
        r0 = *(sp + 0);
        r2 = var0 + (r6 >> 12);
        r1 = *((*(sp + 0)) + 10);
        if ((var0 + (r6 >> 12)) > (*((*(sp + 0)) + 10)))
        {
          r5 = (*((*(sp + 0)) + 10)) - var0;
        }

        r0 = *((*(sp + 0)) + 1);
        r3 = r5;
        r2 = r0 + var0;
        r1 = r8;
        func_0x803ba6a();
        ;
        if ((*((*(sp + 0)) + 1)) != 0)
        {
          *(r4 + 17) = sl;
          r0 = 1;
        }

        r0 = *(r4 + 16);
        if (~((*(r4 + 16)) & 128))
        {
          r0 = *(r4 + 28);
          r0 = (*(r4 + 28)) - (r0 + var0);
          if (((*(r4 + 28)) - (r0 + var0)) < r5)
          {
            var1 = r8 + (((*(r4 + 28)) - (r0 + var0)) << 12);
            r2 = 4096;
            r1 = r4 + 40;
            func_0x803d130(var1, r4 + 40, 4096);
          }

        }

        r5 = r5 << 12;
        r6 = r6 - (r5 << 12);
        r0 = *r9;
        r0 = (*r9) + (r5 << 12);
        *r9 = (*r9) + (r5 << 12);
        r8 = r8 + (r5 << 12);
        r0 = *(r4 + 20);
        r0 = (*(r4 + 20)) + (r5 << 12);
        *(r4 + 20) = (*(r4 + 20)) + (r5 << 12);
        if ((r6 - (r5 << 12)) == 0)
        {
          break;
        }

      }

    }
    else
    {
    }

    r0 = *(r4 + 20);
    r0 = (*(r4 + 20)) & 0xfff;
    r5 = ((*(r4 + 20)) & 0xfff) - 4096;
    if ((((*(r4 + 20)) & 0xfff) - 4096) > r6)
    {
      r5 = r6;
    }

    r0 = ((*(r4 + 20)) & 0xfff) + r4;
    r1 = (((*(r4 + 20)) & 0xfff) + r4) + 40;
    r2 = r5;
    r0 = r8;
    func_0x803d130();
    ;
    r6 = r6 - r5;
    r0 = *r9;
    r0 = (*r9) + r5;
    *r9 = (*r9) + r5;
    r8 = r8 + r5;
    r0 = *(r4 + 20);
    r0 = (*(r4 + 20)) + r5;
    *(r4 + 20) = (*(r4 + 20)) + r5;
    if ((r6 - r5) == 0)
    {
      break;
    }

  }

  r0 = 0;
  return;
}

